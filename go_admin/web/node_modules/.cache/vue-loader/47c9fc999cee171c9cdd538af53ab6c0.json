{"remainingRequest":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\src\\view\\superAdmin\\authority\\components\\datas.vue","mtime":1618795335792},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\BaiduNetdiskDownload\\gin-vue-admin\\web\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge3NldERhdGFBdXRob3JpdHl9IGZyb20gJ0AvYXBpL2F1dGhvcml0eScNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0RhdGFzJywNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgICBhdXRob3JpdHlzOltdLA0KICAgICAgICBkYXRhQXV0aG9yaXR5SWQ6W10sDQogICAgICAgIG5lZWRDb25maXJtOmZhbHNlDQogICAgfQ0KICB9LA0KICBwcm9wczogew0KICAgIHJvdzogew0KICAgICAgZGVmYXVsdDogZnVuY3Rpb24oKSB7DQogICAgICAgIHJldHVybiB7fQ0KICAgICAgfSwNCiAgICAgIHR5cGU6IE9iamVjdA0KICAgIH0sDQogICAgYXV0aG9yaXR5OiB7DQogICAgICBkZWZhdWx0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIHt9DQogICAgICB9LA0KICAgICAgdHlwZTogQXJyYXkNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6ew0KICAgIC8vIOaatOmcsue7meWkluWxguS9v+eUqOeahOWIh+aNouaLpuaIque7n+S4gOaWueazlQ0KICAgICAgZW50ZXJBbmROZXh0KCl7DQogICAgICAgIHRoaXMuYXV0aERhdGFFbnRlcigpDQogICAgICB9LA0KICAgICAgYWxsKCl7DQogICAgICAgICB0aGlzLmRhdGFBdXRob3JpdHlJZCA9IFsuLi50aGlzLmF1dGhvcml0eXNdDQogICAgICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZA0KICAgICAgICAgdGhpcy5uZWVkQ29uZmlybSA9IHRydWUNCiAgICAgIH0sDQogICAgICBzZWxmKCl7DQogICAgICAgICAgdGhpcy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmF1dGhvcml0eXMuZmlsdGVyKGl0ZW09Pml0ZW0uYXV0aG9yaXR5SWQ9PT10aGlzLnJvdy5hdXRob3JpdHlJZCkNCiAgICAgICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZA0KICAgICAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlDQogICAgICB9LA0KICAgICAgc2VsZkFuZENoaWxkcmVuKCl7DQogICAgICAgICBjb25zdCBhcnJCb3ggPSBbXQ0KICAgICAgICAgdGhpcy5nZXRDaGlsZHJlbklkKHRoaXMucm93LGFyckJveCkNCiAgICAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkID0gdGhpcy5hdXRob3JpdHlzLmZpbHRlcihpdGVtPT5hcnJCb3guaW5kZXhPZihpdGVtLmF1dGhvcml0eUlkKT4tMSkNCiAgICAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCA9IHRoaXMuZGF0YUF1dGhvcml0eUlkDQogICAgICAgICB0aGlzLm5lZWRDb25maXJtID0gdHJ1ZQ0KICAgICAgfSwNCiAgICAgIGdldENoaWxkcmVuSWQocm93LGFyckJveCl7DQogICAgICAgICAgYXJyQm94LnB1c2gocm93LmF1dGhvcml0eUlkKQ0KICAgICAgICAgIHJvdy5jaGlsZHJlbiYmcm93LmNoaWxkcmVuLm1hcChpdGVtPT57DQogICAgICAgICAgICAgIHRoaXMuZ2V0Q2hpbGRyZW5JZChpdGVtLGFyckJveCkNCiAgICAgICAgICB9KQ0KICAgICAgfSwNCiAgICAvLyDmj5DkuqQNCiAgICAgIGFzeW5jIGF1dGhEYXRhRW50ZXIoKXsNCiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBzZXREYXRhQXV0aG9yaXR5KHRoaXMucm93KQ0KICAgICAgICAgIGlmKHJlcy5jb2RlID09IDApew0KICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsgdHlwZTogJ3N1Y2Nlc3MnLCBtZXNzYWdlOiAi6LWE5rqQ6K6+572u5oiQ5YqfIiB9KQ0KICAgICAgICAgIH0NCiAgICAgIH0sDQogICAgLy8gICDlubPpk7rop5LoibINCiAgICAgIHJvdW5kQXV0aG9yaXR5KGF1dGhvcml0eXMpew0KICAgICAgICAgIGF1dGhvcml0eXMmJmF1dGhvcml0eXMubWFwKGl0ZW09PnsNCiAgICAgICAgICAgICAgY29uc3Qgb2JqID0ge30NCiAgICAgICAgICAgICAgb2JqLmF1dGhvcml0eUlkID0gaXRlbS5hdXRob3JpdHlJZA0KICAgICAgICAgICAgICBvYmouYXV0aG9yaXR5TmFtZSA9IGl0ZW0uYXV0aG9yaXR5TmFtZQ0KICAgICAgICAgICAgICB0aGlzLmF1dGhvcml0eXMucHVzaChvYmopDQogICAgICAgICAgICAgIGlmKGl0ZW0uY2hpbGRyZW4mJml0ZW0uY2hpbGRyZW4ubGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgIHRoaXMucm91bmRBdXRob3JpdHkoaXRlbS5jaGlsZHJlbikNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICB9LA0KICAgIC8vICAg6YCJ5oupDQogICAgICBzZWxlY3RBdXRob3JpdHkoKXsNCiAgICAgICAgICB0aGlzLnJvdy5kYXRhQXV0aG9yaXR5SWQgPSB0aGlzLmRhdGFBdXRob3JpdHlJZA0KICAgICAgICAgIHRoaXMubmVlZENvbmZpcm0gPSB0cnVlDQogICAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgICB0aGlzLmF1dGhvcml0eXMgPSBbXQ0KICAgICAgdGhpcy5kYXRhQXV0aG9yaXR5SWQgPSBbXQ0KICAgICAgdGhpcy5yb3VuZEF1dGhvcml0eSh0aGlzLmF1dGhvcml0eSkNCiAgICAgIHRoaXMucm93LmRhdGFBdXRob3JpdHlJZCYmdGhpcy5yb3cuZGF0YUF1dGhvcml0eUlkLm1hcChpdGVtPT57DQogICAgICAgICAgY29uc3Qgb2JqID0gdGhpcy5hdXRob3JpdHlzJiZ0aGlzLmF1dGhvcml0eXMuZmlsdGVyKGF1PT5hdS5hdXRob3JpdHlJZCA9PT0gaXRlbS5hdXRob3JpdHlJZCkmJnRoaXMuYXV0aG9yaXR5cy5maWx0ZXIoYXU9PmF1LmF1dGhvcml0eUlkID09PSBpdGVtLmF1dGhvcml0eUlkKVswXQ0KICAgICAgICAgIHRoaXMuZGF0YUF1dGhvcml0eUlkLnB1c2gob2JqKQ0KICAgICAgfSkNCiAgfQ0KfQ0K"},{"version":3,"sources":["datas.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"datas.vue","sourceRoot":"src/view/superAdmin/authority/components","sourcesContent":["<template>\r\n  <div>\r\n      <div class=\"clearflex\" style=\"margin:18px\">\r\n      <el-button @click=\"authDataEnter\" class=\"fl-right\" size=\"small\" type=\"primary\">确 定</el-button>\r\n      <el-button @click=\"all\" class=\"fl-left\" size=\"small\" type=\"primary\">全选</el-button>\r\n      <el-button @click=\"self\" class=\"fl-left\" size=\"small\" type=\"primary\">本角色</el-button>\r\n      <el-button @click=\"selfAndChildren\" class=\"fl-left\" size=\"small\" type=\"primary\">本角色及子角色</el-button>\r\n    </div>\r\n     <el-checkbox-group v-model=\"dataAuthorityId\" @change=\"selectAuthority\">\r\n        <el-checkbox v-for=\"(item,key) in authoritys\" :label=\"item\" :key=\"key\">{{item.authorityName}}</el-checkbox>\r\n    </el-checkbox-group>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {setDataAuthority} from '@/api/authority'\r\nexport default {\r\n  name: 'Datas',\r\n  data() {\r\n    return {\r\n        authoritys:[],\r\n        dataAuthorityId:[],\r\n        needConfirm:false\r\n    }\r\n  },\r\n  props: {\r\n    row: {\r\n      default: function() {\r\n        return {}\r\n      },\r\n      type: Object\r\n    },\r\n    authority: {\r\n      default: function() {\r\n        return {}\r\n      },\r\n      type: Array\r\n    }\r\n  },\r\n  methods:{\r\n    // 暴露给外层使用的切换拦截统一方法\r\n      enterAndNext(){\r\n        this.authDataEnter()\r\n      },\r\n      all(){\r\n         this.dataAuthorityId = [...this.authoritys]\r\n         this.row.dataAuthorityId = this.dataAuthorityId\r\n         this.needConfirm = true\r\n      },\r\n      self(){\r\n          this.dataAuthorityId = this.authoritys.filter(item=>item.authorityId===this.row.authorityId)\r\n          this.row.dataAuthorityId = this.dataAuthorityId\r\n          this.needConfirm = true\r\n      },\r\n      selfAndChildren(){\r\n         const arrBox = []\r\n         this.getChildrenId(this.row,arrBox)\r\n         this.dataAuthorityId = this.authoritys.filter(item=>arrBox.indexOf(item.authorityId)>-1)\r\n         this.row.dataAuthorityId = this.dataAuthorityId\r\n         this.needConfirm = true\r\n      },\r\n      getChildrenId(row,arrBox){\r\n          arrBox.push(row.authorityId)\r\n          row.children&&row.children.map(item=>{\r\n              this.getChildrenId(item,arrBox)\r\n          })\r\n      },\r\n    // 提交\r\n      async authDataEnter(){\r\n          const res = await setDataAuthority(this.row)\r\n          if(res.code == 0){\r\n              this.$message({ type: 'success', message: \"资源设置成功\" })\r\n          }\r\n      },\r\n    //   平铺角色\r\n      roundAuthority(authoritys){\r\n          authoritys&&authoritys.map(item=>{\r\n              const obj = {}\r\n              obj.authorityId = item.authorityId\r\n              obj.authorityName = item.authorityName\r\n              this.authoritys.push(obj)\r\n              if(item.children&&item.children.length){\r\n                  this.roundAuthority(item.children)\r\n              }\r\n          })\r\n      },\r\n    //   选择\r\n      selectAuthority(){\r\n          this.row.dataAuthorityId = this.dataAuthorityId\r\n          this.needConfirm = true\r\n      }\r\n  },\r\n  created() {\r\n      this.authoritys = []\r\n      this.dataAuthorityId = []\r\n      this.roundAuthority(this.authority)\r\n      this.row.dataAuthorityId&&this.row.dataAuthorityId.map(item=>{\r\n          const obj = this.authoritys&&this.authoritys.filter(au=>au.authorityId === item.authorityId)&&this.authoritys.filter(au=>au.authorityId === item.authorityId)[0]\r\n          this.dataAuthorityId.push(obj)\r\n      })\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\">\r\n</style>"]}]}